var myPage=function(a){"use strict";return a.fa={fav:"fa fa-heart",fav_o:"fa fa-heart-o"},a}(myPage||{});!function(a){"use strict";var b=function(a,b){void 0===b&&(b=250);var c=null;return function(){var d=this,e=arguments;clearTimeout(c),c=setTimeout(function(){a.apply(d,e)},b)}},c=function(a,b){void 0===b&&(b=250);var c,d;return function(){var e=this,f=+new Date,g=arguments;d&&f<d+b?(clearTimeout(c),c=setTimeout(function(){d=f,a.apply(e,g)},b)):(d=f,a.apply(e,g))}};if(a.jQuery)var d=function(){var a={},b=function(b,c,d){"boolean"==typeof c&&(d=c,c=!1);var e=c?c.selector+" "+b:b;return(void 0===a[e]||d)&&(a[e]=c?c.find(b):jQuery(b)),a[e]};return b.elementCache=a,b};a.utility={debounce:b,throttle:c},d&&(a.$cache=new d)}(this);var myPage=function(a){"use strict";var b=function(){var a=localStorage.getItem("usda.favorites");if(null==a)return[];a=JSON.parse(a);var b=$.map(a,function(a){return a});return b},c=function(a){localStorage.setItem("usda.favorites",JSON.stringify(a))},d=function(a){for(var c=b(),d=0,e=c.length;d<e;d++)if(c[d].id==a)return!0;return!1},e=function(a){for(var d=b(),e=0,f=d.length;e<f;e++)if(d[e].id==a.id)return d.splice(e,1),c(d),-1;return d.push(a),c(d),1};return a.favorites={exists:d,update:e},a}(myPage||{}),myPage=function(a){"use strict";var b={key:"hd8s8xQRSVIJ2H8CZfCDbZvDtuBus8RUyPwsxruG",searchURL:"http://api.nal.usda.gov/ndb/search/?format=json",nutrientURL:"http://api.nal.usda.gov/ndb/nutrients/?format=json"},c={protein:"203",fat:"204",carbs:"205",fiber:"291"},d=function(a){var c=b.searchURL;return c+="&api_key="+b.key,c+="&q="+a},e=function(a){var d=b.nutrientURL;return d+="&api_key="+b.key,d+="&nutrients="+c.protein,d+="&nutrients="+c.fat,d+="&nutrients="+c.carbs,d+="&nutrients="+c.fiber,d+="&ndbno="+a},f=function(b){var c="";return $.each(b.list.item,function(b,d){var e,f,g;$.each(d,function(a,b){switch(a){case"name":e=b;break;case"ndbno":f=b}}),g=a.fa.fav_o,a.favorites.exists(f)&&(g=a.fa.fav),c+="<div class='searchItem' data-ndbno='"+f+"' data-name='"+e+"'>",c+=e+"<i class='favorite "+g+"'></i>",c+="</div>"}),c},g=function(){return"<div style='text-align:center;'>No results found</div>"},h=function(a){$.ajax({type:"GET",url:d(a),success:function(a){$cache("#results").html(f(a))},error:function(a,b){$cache("#results").html(g())}})},i=function(a){$.ajax({type:"GET",url:e(a),success:function(a){console.log("success")},error:function(a,b){}})};return a.usda={search:h,getNutrients:i},a}(myPage||{});!function(a){"use strict";$cache("#txtSearch").on("keypress",function(b){if(13===b.keyCode){b.preventDefault();var c=$cache("#txtSearch").val();a.usda.search(c),$cache("#txtSearch").blur()}}),$cache("#results").on("click",".searchItem",function(){var b=$(this).attr("data-ndbno");a.usda.getNutrients(b)}).on("click",".favorite",function(b){b.stopPropagation(),$(this).toggleClass(a.fa.fav+" "+a.fa.fav_o);var c=$(this).parent().attr("data-ndbno"),d=$(this).parent().attr("data-name"),e={id:c,name:d};a.favorites.update(e)})}(myPage);